<script>
  const gamesToShow = [
    
  ];
const fetchedGames = []; // ⬅️ 保存所有抓取的游戏数据

  async function loadSpecificGames() {
    const container = document.getElementById('online-game-list');

    for (const name of gamesToShow) {
      try {
        const res = await fetch(`/api/games?search=${encodeURIComponent(name)}`);
        const data = await res.json();
        const game = data.results?.[0];
        if (!game) continue;

        fetchedGames.push({
          name: game.name,
          released: game.released,
          rating: game.rating,
          background_image: game.background_image,
          slug: game.slug,
          platforms: game.platforms?.map(p => p.platform.name) || []
        });

        const platforms = game.platforms?.map(p => p.platform.name).join(',\u200B ') || 'Unknown';
        const card = document.createElement('div');
        card.className = 'game-card';
        card.innerHTML = `
          <a href="https://rawg.io/games/${game.slug}" target="_blank" style="text-decoration: none; color: inherit;">
            <img src="${game.background_image}" alt="${game.name}"/>
            <h3>${game.name}</h3>
            <p><strong>Release:</strong> ${game.released || 'N/A'}</p>
            <p><strong>Rating:</strong> ${game.rating || 'N/A'} ⭐️</p>
            <p><strong>Platforms:</strong> ${platforms}</p>
          </a>
        `;
        container.appendChild(card);
      } catch (err) {
        console.error("Failed to load", name, err);
      }
    }

    // ✅ 所有游戏加载完毕后自动导出为 JSON 文件
    downloadJSON(fetchedGames);
  }

  function downloadJSON(data) {
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'game1.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }

  window.addEventListener('DOMContentLoaded', loadSpecificGames);
</script>
